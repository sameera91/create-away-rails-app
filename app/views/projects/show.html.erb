<%= flash[:success] if flash[:success] %>
<br><br>

<% if current_user && current_user.created_projects.include?(@project) %>
  <%= link_to "Edit project", edit_project_path(@project), class: 'form_button' %>
    <%= link_to 'Delete project',  user_project_path(current_user, @project),
        data: { confirm: 'Are you sure you want to delete this project?' }, method: :delete, class: 'form_button' %><br>
<%end%>

<br><br>

<center><div class="project">

  <h1 class="project_title_1"><%= @project.title %></h1>
  <br>
  <p class="creator">Created by: <%= @user_name %></p>

  <% if !@project.image_file_name.nil? %>
    <center><%= link_to image_tag(@project.image.url, class: 'media-object'), @project.image.url, target: '_blank' %></center>
  <%end%>
  <br>
  <p class="created"><%= @project.short_blurb %></p>


  <div class="likes"><%= pluralize(@project.likes, 'like') %></div>

  <br><br><br>
  <% @project.categories.each do |category| %>
    <p><%= category.name %></p>
  <%end%>

</div></center>
<br>

<p id="comments">Comments:</p>

<% @project.comments.each do |comment| %>
  <%= link_to comment.content, project_comment_path(@project, comment) if !comment.content.nil? %>
  <div class="created">By: <%= User.find(comment.user_id).name%></div><br>
<%end%>
<br>

<% if current_user && !current_user.created_projects.include?(@project) %>
  <%= link_to "Like", project_like_path(@project), class: 'btn btn-default glyphicon glyphicon-thumbs-up' %><br><br>
<%end%>

<% if current_user %>
  <button class="post_comment btn btn-primary">Post a comment</button>
<% else %>
  <%= link_to "Sign in", user_session_path %> to like or post a comment!
<%end%>


<a href="#" class="next-project" data-id="<%=@project.id%>">Next</a>

<div id="form"> 

<% @project.comments.each do |comment| %>
  <%# comment = Comment.new %>
  <%#= render "comments/form", :comment => comment %>
<%end%>

  <%= form_for ([@project, Comment.new(project_id: @project.id)]) do |f| %>
    <%= f.hidden_field :project_id %>
    <%= f.label "Comment" %><br>
    <%= f.text_area :content, class: 'text-area' %><br><br>
    <%= f.submit class: 'btn btn-primary' %>
  <%end%>
</div>

<script type="text/javascript" charset="utf-8">
$(function () {
  /*$(".next-project").on("click", function(event) {


    var projectUrl = event["target"]["href"]

    var projectId = parseInt(projectUrl.slice(0,-1).slice(-1))+1;
    console.log(projectId);

    $.get("/projects/" + projectId + ".json", function(data){
      $("body").html(data);
    });

  });*/

  $("#form").hide();

  $(".post_comment").click(function(event){
    $("#form").toggle();
  });
});


</script>
